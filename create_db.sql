CREATE SCHEMA `employees`;

USE employees;

CREATE TABLE ADRESSES
  (
    ADRESSES_ID   INT (4) NOT NULL ,
    STREET        VARCHAR(45)   NULL ,
    POSTAL_CODE VARCHAR(45)   NULL ,
    CITY       VARCHAR(45)  NOT NULL ,
    COUNTRY_ID    INT (4) NOT NULL
  ) ;
ALTER TABLE ADRESSES ADD CONSTRAINT ADRESSES_PK PRIMARY KEY ( ADRESSES_ID ) ;


CREATE TABLE POSITION_HIST
  (
    EMPLOYEE_ID            INT (4) NOT NULL ,
    WAGE                DATE ,
    END_DATE                 DATE ,
    BRANCH_ID               INT (4) NOT NULL ,
    POSITION_ID           INT (4) NOT NULL ,
    PRIMARY KEY ( EMPLOYEE_ID, WAGE, END_DATE )
  ) ;

CREATE TABLE COUNTRIES
  (
    COUNTRY_ID   INT (4) NOT NULL ,
    NAME       VARCHAR(45)  NOT NULL ,
    REGION_ID INT (4) NOT NULL
  ) ;
ALTER TABLE COUNTRIES ADD CONSTRAINT COUNTRIES_PK PRIMARY KEY ( COUNTRY_ID ) ;


CREATE TABLE EMPLOYEES
  (
    EMPLOYEE_ID     INT (4) NOT NULL ,
    FIRST_NAME              VARCHAR(45)  NOT NULL ,
    LAST_NAME          VARCHAR(45)  NOT NULL ,
    WAGE           INT  ,
    BEGIN_DATE DATE ,
    BRANCH_ID        INT (4) NOT NULL ,
    SUPERVISOR_ID     INT (4) ,
    POSITION_ID    INT (4) NOT NULL
  ) ;
ALTER TABLE EMPLOYEES ADD CONSTRAINT EMPLOYEES_PK PRIMARY KEY ( EMPLOYEE_ID ) ;


CREATE TABLE REGIONS
  (
    REGION_ID INT (4) NOT NULL ,
    NAME       VARCHAR(45)  NOT NULL
  ) ;
ALTER TABLE REGIONS ADD CONSTRAINT REGIONS_PK PRIMARY KEY ( REGION_ID ) ;


CREATE TABLE POSITIONS
  (
    POSITION_ID INT (4) NOT NULL ,
    NAME          VARCHAR(45)  NOT NULL ,
    MIN_WAGE      INT  ,
    MAX_WAGE      INT 
  ) ;
ALTER TABLE POSITIONS ADD CONSTRAINT POSITIONS_PK PRIMARY KEY ( POSITION_ID ) ;


CREATE TABLE BRANCHES
  (
    BRANCH_ID    INT (4) NOT NULL ,
    NAME_zakladu VARCHAR(45)  NOT NULL ,
    ADRESSES_ID    INT (4) NOT NULL,
    SUPERVISOR_ID INT (4)
  ) ;
  
ALTER TABLE BRANCHES ADD CONSTRAINT BRANCHES_PK PRIMARY KEY ( BRANCH_ID ) ;


ALTER TABLE ADRESSES ADD CONSTRAINT ADRESSES_COUNTRIES_FK FOREIGN KEY ( COUNTRY_ID ) REFERENCES COUNTRIES ( COUNTRY_ID ) ;

ALTER TABLE POSITION_HIST ADD CONSTRAINT HS_EMPLOYEES_FK FOREIGN KEY ( EMPLOYEE_ID ) REFERENCES EMPLOYEES ( EMPLOYEE_ID ) ;

ALTER TABLE POSITION_HIST ADD CONSTRAINT HS_POSITIONS_FK FOREIGN KEY ( POSITION_ID ) REFERENCES POSITIONS ( POSITION_ID ) ;

ALTER TABLE POSITION_HIST ADD CONSTRAINT HS_BRANCHES_FK FOREIGN KEY ( BRANCH_ID ) REFERENCES BRANCHES ( BRANCH_ID ) ;

ALTER TABLE COUNTRIES ADD CONSTRAINT COUNTRIES_REGIONS_FK FOREIGN KEY ( REGION_ID ) REFERENCES REGIONS ( REGION_ID ) ;

ALTER TABLE EMPLOYEES ADD CONSTRAINT EMPLOYEES_EMPLOYEES_FK FOREIGN KEY ( SUPERVISOR_ID ) REFERENCES EMPLOYEES ( EMPLOYEE_ID ) ;

ALTER TABLE EMPLOYEES ADD CONSTRAINT EMPLOYEES_POSITIONS_FK FOREIGN KEY ( POSITION_ID ) REFERENCES POSITIONS ( POSITION_ID ) ;

ALTER TABLE EMPLOYEES ADD CONSTRAINT EMPLOYEES_BRANCHES_FK FOREIGN KEY ( BRANCH_ID ) REFERENCES BRANCHES ( BRANCH_ID ) ;

ALTER TABLE BRANCHES ADD CONSTRAINT BRANCHES_ADRESSES_FK FOREIGN KEY ( ADRESSES_ID ) REFERENCES ADRESSES ( ADRESSES_ID ) ;

commit; 


INSERT INTO REGIONS VALUES (101, 'EUROPA');
INSERT INTO REGIONS VALUES (102, 'AFRYKA');
INSERT INTO REGIONS VALUES (103, 'AMERYKA PN');
INSERT INTO REGIONS VALUES (104, 'AMERYKA PLD');
INSERT INTO REGIONS VALUES (105, 'AMERYKA PD');
INSERT INTO REGIONS VALUES (106, 'BLISKI WSCHOD');
INSERT INTO REGIONS VALUES (107, 'DALEKI WSCHOD');
INSERT INTO REGIONS VALUES (108, 'AUSTRALIA');
commit;
-------------------

INSERT INTO COUNTRIES VALUES (101, 'WB', 101);
INSERT INTO COUNTRIES VALUES (102, 'NIEMCY', 101);
INSERT INTO COUNTRIES VALUES (103, 'FRANCJA', 101);
INSERT INTO COUNTRIES VALUES (104, 'POLSKA', 101);
INSERT INTO COUNTRIES VALUES (105, 'CZECHY', 101);
INSERT INTO COUNTRIES VALUES (106, 'LITWA', 101);
INSERT INTO COUNTRIES VALUES (107, 'UKRAINA', 101);
INSERT INTO COUNTRIES VALUES (108, 'SLOWACJA', 101);
INSERT INTO COUNTRIES VALUES (109, 'NORWEGIA', 101);
INSERT INTO COUNTRIES VALUES (110, 'SZWECJA', 101);
INSERT INTO COUNTRIES VALUES (111, 'FINLANDIA', 101);
INSERT INTO COUNTRIES VALUES (112, 'HISZPANIA', 101);

INSERT INTO COUNTRIES VALUES (113, 'RPA', 102);
INSERT INTO COUNTRIES VALUES (114, 'EGIPT', 102);

INSERT INTO COUNTRIES VALUES (115, 'IZRAEL', 106);
INSERT INTO COUNTRIES VALUES (116, 'IRAK', 106);
INSERT INTO COUNTRIES VALUES (117, 'TURCJA', 106);

INSERT INTO COUNTRIES VALUES (118, 'USA', 103);
INSERT INTO COUNTRIES VALUES (119, 'KANADA', 103);

INSERT INTO COUNTRIES VALUES (120, 'BRAZYLIA', 105);
INSERT INTO COUNTRIES VALUES (121, 'ARGENTYNA', 105);

INSERT INTO COUNTRIES VALUES (122, 'CHINY', 107);
INSERT INTO COUNTRIES VALUES (123, 'JAPONIA', 107);
INSERT INTO COUNTRIES VALUES (124, 'KOREA PD', 107);
commit;
----------------

INSERT INTO ADRESSES VALUES (1001, 'NOWA', '00-123', 'WARSZAWA', 104);
INSERT INTO ADRESSES VALUES (1002, 'BLISKA', '12-234', 'KRAKOW', 104);
INSERT INTO ADRESSES VALUES (1003, 'KOPERNIKA', '32-112', 'TORUN', 104);
INSERT INTO ADRESSES VALUES (1004, 'KRAKOWSKA', '55-123', 'POZNAN', 104);
INSERT INTO ADRESSES VALUES (1005, 'OXFORD STREET', '23AB1', 'LONDYN', 101);
INSERT INTO ADRESSES VALUES (1006, 'Kreisfreie Stat', '10115', 'BERLIN', 102);
INSERT INTO ADRESSES VALUES (1007, 'rue Foobar', '75722', 'PARYZ', 103);
INSERT INTO ADRESSES VALUES (1008, 'Obchodni', 'CZ251', 'PRAGA', 105);
INSERT INTO ADRESSES VALUES (1009, 'Vienuolio', '00004', 'WILNO', 106);
INSERT INTO ADRESSES VALUES (1010, 'Zythomyra', '03000-123' ,'KIJOW', 107);
INSERT INTO ADRESSES VALUES (1011, 'Chester Road', '09622', 'MANCHESTER', 101);
INSERT INTO ADRESSES VALUES (1012, 'Spadina Ave', 'm5V 2L7', 'TORONTO', 119);
INSERT INTO ADRESSES VALUES (1013, 'Boxwood St', 'm56 2k1', 'TORONTO', 119);
INSERT INTO ADRESSES VALUES (1014, 'ALBERTA ST', 'm66 24a', 'TORONTO', 119);
INSERT INTO ADRESSES VALUES (1015, 'Back ST', '23A123', 'Sao Paulo' , 118);
INSERT INTO ADRESSES VALUES (1016, '2014 Jabberwocky Rd', '26192', 'Southlake', 118);
INSERT INTO ADRESSES VALUES (1017, '2011 Interiors Blvd', '99236', 'South San Francisco', 118);
INSERT INTO ADRESSES VALUES (1018, '2007 Zagora St', '50090', 'South Brunswick', 118);
INSERT INTO ADRESSES VALUES (1019, '2004 Charade Rd', '98199', 'Seattle', 118);
iNSERT INTO ADRESSES VALUES (1020, '2017 Shinjuku-ku', '1689', 'Tokyo', 123);
commit;
------------------


INSERT INTO BRANCHES VALUES (101, 'Administracja', 1001, null);
INSERT INTO BRANCHES VALUES (102, 'Marketing', 1001, null);
INSERT INTO BRANCHES VALUES (103, 'Kadry', 1002, null);
INSERT INTO BRANCHES VALUES (104, 'Wsparcie IT', 1002, null);
INSERT INTO BRANCHES VALUES (105, 'Sprzedaz', 1013, null);
INSERT INTO BRANCHES VALUES (106, 'Produkcja', 1013, null);
INSERT INTO BRANCHES VALUES (107, 'Kierownictwo', 1014, null);
INSERT INTO BRANCHES VALUES (108, 'Finanse', 1015, null);
INSERT INTO BRANCHES VALUES (109, 'Benefity', 1016, null);
INSERT INTO BRANCHES VALUES (110, 'Helpdesk', 1018, null);
INSERT INTO BRANCHES VALUES (111, 'Kontrakty', 1019, null);
INSERT INTO BRANCHES VALUES (112, 'Techniczny', 1019, null);
INSERT INTO BRANCHES VALUES (113, 'Rekrutacja', 1007, null);
INSERT INTO BRANCHES VALUES (114, 'Operacyjny', 1008, null);
INSERT INTO BRANCHES VALUES (115, 'Planistyczny', 1008, null);
INSERT INTO BRANCHES VALUES (116, 'Kontrolny', 1005, null);
INSERT INTO BRANCHES VALUES (117, 'Produkcja IT', 1002, null);
INSERT INTO BRANCHES VALUES (118, 'Grafika', 1005, null);
INSERT INTO BRANCHES VALUES (119, 'Wdrozenia', 1009, null);
commit;
---------------------

INSERT INTO POSITIONS VALUES (101, 'Programista', 2000, 7000);
INSERT INTO POSITIONS VALUES (102, 'Konsultat', 1000, 5500);
INSERT INTO POSITIONS VALUES (103, 'Kadrowy', 1000, 4000);
INSERT INTO POSITIONS VALUES (104, 'Manager marketingowy', 1000, 3000);
INSERT INTO POSITIONS VALUES (105, 'Reprezentant', 1500, 4500);
INSERT INTO POSITIONS VALUES (106, 'Techniczny', 1300, 3000);
INSERT INTO POSITIONS VALUES (107, 'Wdrozeniowiec', 1400, 5000);
INSERT INTO POSITIONS VALUES (108, 'Pracownik RD', 2400, 9000);
INSERT INTO POSITIONS VALUES (109, 'Rekruter', 3000, 7000);
INSERT INTO POSITIONS VALUES (110, 'Public Relations', 3000, 7000);
INSERT INTO POSITIONS VALUES (111, 'Lider zespolu', 4000, 9000);
INSERT INTO POSITIONS VALUES (112, 'Kierowca', 1000, 2500);
INSERT INTO POSITIONS VALUES (113, 'Administracyjny', 2000, 4000);
INSERT INTO POSITIONS VALUES (114, 'Grafik', 2000, 7000);
INSERT INTO POSITIONS VALUES (115, 'Szkoleniowiec', 1500, 4000);
INSERT INTO POSITIONS VALUES (116, 'Analityk', 2500, 9000);
INSERT INTO POSITIONS VALUES (117, 'Projektant', 2500, 9000);
commit;

-------------------------


INSERT INTO EMPLOYEES VALUES (101, 'Piotr', 'Maciejewski', 3000, '09/01/01', 101, NULL, 101);
INSERT INTO EMPLOYEES VALUES (102, 'Piotr', 'Janowski', 3000, '09/01/01', 102, 101, 102);
INSERT INTO EMPLOYEES VALUES (103, 'Andrzej', 'King', 1500, '09/01/01', 102, 101, 103);
INSERT INTO EMPLOYEES VALUES (104, 'Lex', 'Kochhar', 2000, '09/04/15', 102, 101, 104);
INSERT INTO EMPLOYEES VALUES (105, 'Alexander', 'Hunold', 3000, '09/04/15', 103, 101, 105);
INSERT INTO EMPLOYEES VALUES (106, 'Bruce', 'Hunold', 2000, '09/04/15', 103, 102, 106);
INSERT INTO EMPLOYEES VALUES (107, 'David', 'Ernst', 4500, '09/04/15', 104, NULL, 107);
INSERT INTO EMPLOYEES VALUES (108, 'Valli', 'Austin', 4000, '09/04/15', 104, 107, 108);
INSERT INTO EMPLOYEES VALUES (109, 'Diana', 'Pataballa', 6000, '09/04/15', 104, 107, 109);
INSERT INTO EMPLOYEES VALUES (110, 'Nancy', 'Lorentz', 5000, '09/05/16', 105, 107, 110);
INSERT INTO EMPLOYEES VALUES (111, 'Daniel', 'Greenberg', 7000, '09/05/16', 104, 107, 111);
INSERT INTO EMPLOYEES VALUES (112, 'John', 'Faviet', 1200, '10/11/11', 105, 101, 112);
INSERT INTO EMPLOYEES VALUES (113, 'Ismael', 'Chen', 3300, '10/11/11', 105, 112, 113);
INSERT INTO EMPLOYEES VALUES (114, 'Jose Manuel', 'Sciarra', 3036, '10/11/11', 101, 112, 114);
INSERT INTO EMPLOYEES VALUES (115, 'Luis', 'Urman', 2700, '10/11/11', 112, 112, 115);
INSERT INTO EMPLOYEES VALUES (116, 'Luis', 'Popp', 5000, '10/11/11', 112, NULL, 116);
INSERT INTO EMPLOYEES VALUES (117, 'Den', 'Raphaely', 4000, '10/11/11', 113, 116, 117);
INSERT INTO EMPLOYEES VALUES (118, 'Alexander', 'Khoo', 3000, '10/11/11', 113, 116, 101);
INSERT INTO EMPLOYEES VALUES (119, 'Shelli', 'Baida', 2500, '11/11/20', 114, 116, 102);
INSERT INTO EMPLOYEES VALUES (120, 'Sigal', 'Tobias', 1500, '11/11/20', 114, 116, 103);
INSERT INTO EMPLOYEES VALUES (121, 'Guy', 'Himuro', 1500, '11/11/20', 111, NULL, 104);
INSERT INTO EMPLOYEES VALUES (122, 'Karen', 'Himuro', 2100, '12/02/02', 110, 121, 105);
INSERT INTO EMPLOYEES VALUES (123, 'Matthew', 'Colmenares', 2200, '12/02/02', 111, 121, 106);
INSERT INTO EMPLOYEES VALUES (124, 'Adam', 'Weiss', 2300, '12/02/02', 108, 121, 107);
INSERT INTO EMPLOYEES VALUES (125, 'Adam', 'Fripp', 4200, '12/03/14', 109, NULL, 108);
INSERT INTO EMPLOYEES VALUES (126, 'Kevin', 'Kaufling', 4300, '12/03/14', 107, 126, 109);
INSERT INTO EMPLOYEES VALUES (127, 'Julia', 'Vollman', 4500, '12/06/14', 107, 126, 110);
INSERT INTO EMPLOYEES VALUES (128, 'Irene', 'Janowski', 4200, '12/06/14', 107, 126, 111);
INSERT INTO EMPLOYEES VALUES (129, 'Steven', 'Mourgos', 2300, '12/06/14', 115, 128, 112);
INSERT INTO EMPLOYEES VALUES (130, 'Steven', 'Janowski', 3100, '12/09/01', 115, 128, 113);
INSERT INTO EMPLOYEES VALUES (131, 'Mozhe', 'Nayer', 3250, '12/09/01', 116, 128, 114);
INSERT INTO EMPLOYEES VALUES (132, 'James', 'Mikkilineni', 4100, '12/09/01', 116, 128, 111);
INSERT INTO EMPLOYEES VALUES (133, 'Jason', 'Landry', 1200, '12/09/01', 117, 128, 112);
INSERT INTO EMPLOYEES VALUES (134, 'Michael', 'Markle', 3000, '12/10/01', 116, 128, 113);
INSERT INTO EMPLOYEES VALUES (135, 'Ki', 'Bissot', 3000, '12/10/01', 116, 128, 114);
INSERT INTO EMPLOYEES VALUES (136, 'Renske', 'Atkinson', 4200, '12/10/01', 116, NULL, 111);
INSERT INTO EMPLOYEES VALUES (137, 'Stephen', 'Atkinson', 2200, '12/10/01', 117, 137, 102);
INSERT INTO EMPLOYEES VALUES (138, 'John', 'Marlow', 2300, '13/01/01', 111, 137, 103);
INSERT INTO EMPLOYEES VALUES (139, 'Joshua', 'Olson', 3000, '13/01/01', 113, 137, 103);
INSERT INTO EMPLOYEES VALUES (141, 'Trenna', 'Mallin', 2900, '13/01/01', 112, 137, 104);
INSERT INTO EMPLOYEES VALUES (142, 'Randall', 'Rogers', 3000, '13/04/04', 112, 137, 105);
INSERT INTO EMPLOYEES VALUES (143, 'Peter', 'Gee', 2090,  '13/04/04', 105, 137, 104);
INSERT INTO EMPLOYEES VALUES (144, 'John', 'Philtanker', 3000, '14/04/01', 116, 137, 102);
commit;

-----------------

UPDATE BRANCHES SET SUPERVISOR_ID = 101
WHERE BRANCH_ID = 101;
UPDATE BRANCHES SET SUPERVISOR_ID = 101
WHERE BRANCH_ID = 102;
UPDATE BRANCHES SET SUPERVISOR_ID = 101
WHERE BRANCH_ID = 103;
UPDATE BRANCHES SET SUPERVISOR_ID = 101
WHERE BRANCH_ID = 104;
UPDATE BRANCHES SET SUPERVISOR_ID = 107
WHERE BRANCH_ID = 105;
UPDATE BRANCHES SET SUPERVISOR_ID = 107
WHERE BRANCH_ID = 106;
UPDATE BRANCHES SET SUPERVISOR_ID = 107
WHERE BRANCH_ID = 107;
UPDATE BRANCHES SET SUPERVISOR_ID = 112
WHERE BRANCH_ID = 108;
UPDATE BRANCHES SET SUPERVISOR_ID = 112
WHERE BRANCH_ID = 109;
UPDATE BRANCHES SET SUPERVISOR_ID = 112
WHERE BRANCH_ID = 110;
UPDATE BRANCHES SET SUPERVISOR_ID = 112
WHERE BRANCH_ID = 111;
UPDATE BRANCHES SET SUPERVISOR_ID = 116
WHERE BRANCH_ID = 112;
UPDATE BRANCHES SET SUPERVISOR_ID = 116
WHERE BRANCH_ID = 113;
UPDATE BRANCHES SET SUPERVISOR_ID = 116
WHERE BRANCH_ID = 114;
UPDATE BRANCHES SET SUPERVISOR_ID = 116
WHERE BRANCH_ID = 115;
UPDATE BRANCHES SET SUPERVISOR_ID = 121
WHERE BRANCH_ID = 116;
UPDATE BRANCHES SET SUPERVISOR_ID = 121
WHERE BRANCH_ID = 117;
UPDATE BRANCHES SET SUPERVISOR_ID = 136
WHERE BRANCH_ID = 118;
UPDATE BRANCHES SET SUPERVISOR_ID = 136
WHERE BRANCH_ID = 119;
commit;

-------------------------------

INSERT INTO POSITION_HIST VALUES (101, '05/01/01', '05/03/03', 101, 101);
INSERT INTO POSITION_HIST VALUES (101, '05/03/03', '05/11/01', 102, 102);
INSERT INTO POSITION_HIST VALUES (101, '05/11/01', '05/12/01', 103, 103);
INSERT INTO POSITION_HIST VALUES (102, '04/01/01', '03/10/11', 104, 104);
INSERT INTO POSITION_HIST VALUES (102, '04/10/15', '05/01/01', 105, 105);
INSERT INTO POSITION_HIST VALUES (102, '05/11/20', '06/12/01', 106, 106);
INSERT INTO POSITION_HIST VALUES (102, '06/12/11', '07/05/01', 107, 107);
INSERT INTO POSITION_HIST VALUES (104, '05/03/03', '05/04/04', 108, 108);
INSERT INTO POSITION_HIST VALUES (104, '05/12/12', '06/12/12', 108, 101);
INSERT INTO POSITION_HIST VALUES (104, '06/12/12', '07/03/03', 108, 102);
INSERT INTO POSITION_HIST VALUES (104, '07/03/03', '07/11/11', 102, 103);
INSERT INTO POSITION_HIST VALUES (105, '05/01/01', '05/11/11', 112, 104);
INSERT INTO POSITION_HIST VALUES (105, '05/11/12', '06/10/10', 112, 105);
INSERT INTO POSITION_HIST VALUES (105, '06/10/11', '07/11/11', 112, 106);
INSERT INTO POSITION_HIST VALUES (106, '05/01/01', '08/01/01', 109, 107);
INSERT INTO POSITION_HIST VALUES (107, '05/01/01', '05/11/11', 109, 108);
INSERT INTO POSITION_HIST VALUES (107, '06/06/12', '07/12/12', 109, 107);
INSERT INTO POSITION_HIST VALUES (107, '07/01/01', '08/10/10', 109, 106);
INSERT INTO POSITION_HIST VALUES (111, '05/01/01', '06/01/01', 102, 105);
INSERT INTO POSITION_HIST VALUES (111, '06/01/01', '07/11/01', 102, 104);
INSERT INTO POSITION_HIST VALUES (111, '07/11/01', '08/01/01', 102, 103);
INSERT INTO POSITION_HIST VALUES (111, '08/01/01', '08/12/01', 102, 102);
INSERT INTO POSITION_HIST VALUES (112, '08/01/01', '08/06/01', 102, 101);
INSERT INTO POSITION_HIST VALUES (112, '08/06/01', '08/12/01', 102, 102);
INSERT INTO POSITION_HIST VALUES (113, '05/01/01', '07/01/01', 102, 103);
commit;